---
title: "通过公式对Excel数据表中数据进行计算与查看"
date: "2020-11-13"
categories: 
  - "02"
  - "03"
---

```
如何用DataFocus对Excel表中数据进行分析?
```

上文提到，DataFocus系统中的公式，使用简单但多样，包括聚合公式、分析公式、日期公式、混合函数、数字函数、逻辑操作符、文本操作函数等等类别。那么，如何使用这些公式，对Excel数据表中数据进行计算与查看呢？接下来，我们开始探究DataFocus系统公式的使用。

## 公式的创建与使用

DataFocus系统中公式的使用以及数据分析，是在搜索界面完成的。

将Excel数据表导入系统，并在搜索界面中选择该源表后，即可开始使用公式进行数据分析。具体操作如下：

1. 在搜索页面点击左下角 “增加公式”按钮会弹出一个公式填写界面。
2. 在空白栏中输入要用的公式或者是利用右边‘公式辅助’按钮选择自己想要的公式，鼠标悬停在公式上，下方会出现对于该公式的解释说明以及样例。
3. 编写好的公式可以自己命名，点击公式名，对公式名字进行编辑（不能与关键词同名）。
4. 若公式计算的最终结果是数值，则在公式输入框下方的“高级设置”中可以修改该公式的聚合方式及列类型。
5. 公式输入正确后点击确定，该公式便会添加在数据表的最下方。
6. 双击该公式即可将公式加入到搜索框内，公式计算结果会显示在报表中。

## 按条件计算

在日常工作中，我们除了需要对数据进行计算，还需要对满足某个特定条件的数据进行计算。

### 2.1 单条件计算

#### 2.1.1 sum\_if

sum\_if 用于按照指定条件对数据求和。

例如，一份销售数据中，需要统计出华南区域的销售金额。则可编辑公式：sum\_if (区域=“华南”,销售金额) 。

![](images/word-image-61.png)

图表2. 1 sum\_if

#### 2.1.2 count\_if

公式count\_if ，按条件计数，用于计算列中给定条件的行数。

例如，统计销售金额大于1000的订单数。则编辑公式：count\_if(销售金额大于1000,订单单号)，进行统计。

![](images/word-image-62.png)

图表2. 2 count\_if

### 2.2 多条件计算

在日常工作中，条件计算不局限于单条件，多条件计算也比较普遍，以公式average\_if为例。

average\_if 按条件求平均值，可以返回某列中符合给定条件的所有行的平均值。

例如，计算华南区域，销售价格大于2的产品的平均运输成本。编辑公式：average\_if(区域="华南"and 销售价格 大于 2,运输成本)。

![](images/word-image-65.png)

图表2. 3 average\_if

除了以上三种公式，在DataFocus系统中，对Excel数据的按条件计算，还包括“按条件求均方差”、“按条件求标准差”、“按条件求最大值”、“按条件求最小值”、“按条件求非重复计数”等等公式。当然，除此之外，更多丰富的搜索结果，还可以使用日期公式、混合函数、数字函数、逻辑操作符、文本操作函数等公式，这些内容待我们后续去探究。
