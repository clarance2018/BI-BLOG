---
title: "如何用DataFocus对Excel表中数据进行数据转换"
date: "2020-11-10"
categories: 
  - "02"
  - "03"
---

上一篇，我们简单了解了如何在DataFocus系统中对Excel表的“重复数据”和“缺失数据”进行快速查找和清洗处理。今天，我们将继续了解在处理Excel数据时涉及的“数据转换”操作。

## 一、导入Excel数据表

在数据处理之前，我们先了解下如何将本地Excel数据表导入到DataFocus系统中。大致流程如下：

1. 数据表管理模块的“导入表”栏下选择导入本地文件（或资源管理功能模块中点击“创建资源”按钮）。
2. 选定“EXCEL”文件类型，并在选择本地文件后点击“上传“。
3. 上传成功后的 Excel表配置信息界面，可以选择导入的列、重新命名表名及列名、修改列类型等等，配置完成确认无误后点击“确定”完成上传。

## 二、数据转换

### 2.1 行列转换

当数据的显示方式不满足我们的需要，需要进行“行列转换”时，可以在DataFocus系统的搜索模块中实现。

进入系统的搜索模块，选择数据源表后，双击或在搜索框中输入列名，以完成对转换数据的选择。选择好需要转换的列信息后，从操作栏中进入“数据转换”编辑界面。数据行列转换的类型包括“行转列”和“列转行”。

![](images/word-image-26.png)

图表2. 1 行列转换

#### 2.1.1 行转列

行转列用于将数据按某一列的列中值转化为对应的多个列。

若在“数据转换”的编辑界面选择“行转列”的转换类型，则需要勾选转化的属性列和对应的数值列（可一可多），并点击下一步，审查行转列配置，最后点击确认就可以转化为目标数据了。

![](images/word-image-28.png)

图表2. 2 行转列

#### 2.1.1 列转行

列转行用于将多列数值列转化为有单一映射关系的两个列（1个属性列1个数值列）。

若在该编辑界面选择“列转行”的转换类型，则需要勾选转化的数值列，并点击下一步，

重新定义转化后的1个属性列1个数值列的列名，最后点击确定就可以转化为目标数据了。

![](images/word-image-30.png)

图表2. 3 列转行

### 2.2 列列交换

在Excel表中对数据整理时，常常会出现需要将列与列之间的数据互换位置的情况。而在DataFocus系统中，因为采用搜索式分析，在搜索框中输入列名并选择表格的展现形式后，列信息的展示顺序是按输入顺序进行展现的，所以若需互换列与列的位置，直接在搜索框中对列名进行左右拖动即可。

### 2.3数据类型的转换

在将Excel数据表导入DataFocus系统时，系统会根据表中数据自动识别列类型，也可以进行人为设置。而导入系统后的数据表，若想更换列的数据类型，可以通过公式来实现。

在系统的搜索模块选择数据源表后，点击“添加公式”。在公式编辑界面的“公式辅助”中可以看到转换数据类型的公式以及公式的说明和使用样例。转换公式包括to\_bool ，to\_date ，to\_double ，to\_integer ，to\_string 。

![](images/word-image-32.png)

图表2. 4 数据类型的转换

在DataFocus系统中对Excel数据表进行数据转换时，可能会涉及“字符串连接”、“字符串获取”、“为日期列添加年份”等操作。大家在熟悉系统公式后，对于这些任务也可以轻松地完成。
