---
title: "如何用DataFocus对Excel表中数据进行汇总?"
date: "2020-11-13"
categories: 
  - "02"
  - "03"
---

```
如何用DataFocus对Excel表中数据进行汇总?
```

前面的文章中，我们了解到如何将Excel数据表导入到DataFocus系统中，并对数据进行整理加工以及简单的图表制作。接下来，我们开始数据分析的讲解，即用DataFocus系统对Excel表进行数据分析。

## 一、数据的搜索分析

在使用DataFocus系统进行数据分析之前，我们需要先了解系统中进行“数据分析”的位置和操作方式。

### 1.1 数据源的选择

登录系统并将Excel数据表导入和整理后，进入搜索功能模块进行搜索式数据分析。首先需进行数据源表的选择。

点击搜索功能模块页面左上角的“选择数据”按钮，进入“选择数据源”界面选择数据源表。可选择一个数据表，或者选择多个已经创建过关联关系的数据表，并且可以跨种类数据源选择。点击确定后，被选中的表就会显示在页面左侧。

1.2 搜索式分析

选择数据源表后，对数据进行搜索式分析。搜索数据的方式有两种：

A、 双击页面左侧数据表下的列名进行搜索，搜索框内会显示选择的列名，搜索的结果会显示在页面中间空白部分；

B、 直接在搜索框里输入想要搜索的内容，例如输入：按订单日期计算的销售金额的月增长率，DataFocus会根据搜索条件返回结果。

DataFocus搜索基于数据表，所以在搜索框里可以输入任何相关的单词进行搜索，如 列名称、关键词、同义词、列中值。

## 分类汇总

分类汇总，对同一类别的记录进行合计或小计。在数据分析过程中，得到相关统计结果是一项比较重要的内容。在进行分类汇总前先要确定想得到哪方面的统计结果，然后有针对性地搜索目标字段，并进行分类汇总。

### 2.1 简单的汇总

对表中列信息进行简单汇总，可直接采用搜索的方式实现。例如，想统计出各子类别产品的销售额。直接搜索“产品子类别”“销售金额”，系统会显示出数据表中各子类别产品的总销售金额。

![](images/word-image-58.png)

图表2. 1 各子类别产品销售额

在对数值列进行搜索时，系统会默认以“总和”的方式聚合。若更改数据的汇总计算，可直接在列名后输入文字或根据提示选择汇总计算方式，例如平均值、最大值、方差、标准差、计数等等。

![](images/word-image-59.png)

图表2. 2 更改聚合方式

### 2.2 数据透视表的应用

数据透视表是一种交互式的报表，可以动态改变版面布置。当需要统计很多记录时，使用数据透视表就很有必要了。

例如统计2019年每季度各子类别产品的销售金额、销售数量，并对各子类别的数据进行合计。

在搜索框中输入所需数据列的名称：“产品子类别”、“产品名称”、“销售数量”、“销售金额”，并使用关键词进行日期的筛选。在“图形转换”中选择数据透视表，直接拖动表中列名使数据按需要的形式展现。

如图所示，可直接看到2019年各季度各产品子类别的总销售金额和总销售数量，并可对子类别下的各产品的销售金额和销售数量进行详细查看。

![](images/word-image-60.png)

图表2. 3 数据透视表

### 2.3 查看明细

若需查看列中明细的各类统计情况，则需要使用筛选关键词或图表中的筛选功能来实现。

例如，查看属于“坚果”子类别、总销售金额大于50000的产品以及销售金额。则在系统搜索框中，输入筛选条件“产品子类别包含’坚果’”“销售金额的总和大于50000”，并输入所列“销售金额”、“产品名称”。

![](images/word-image-63.png)

图表2. 4 数据筛选

### 2.4 复杂的计算

对于数据的计算，除了上面提到的“大于”、“总和”、“最大值”等关键词的使用，也可以使用系统支持的公式。较为复杂的计算，甚至结果的嵌套，都能通过公式得以实现。

1. 在搜索页面点击左下角 ‘增加公式’按钮会弹出一个公式填写界面，如下图。
2. 在空白栏中输入要用的公式或者是利用右边‘公式辅助’按钮选择自己想要的公式，鼠标悬停在公式上，下方会出现对于该公式的解释说明以及样例。
3. 编写好的公式可以自己命名，点击公式名，对公式名字进行编辑（不能与关键词同名）。
4. 若公式计算的最终结果是数值，则在公式输入框下方的“高级设置”中可以修改该公式的聚合方式及列类型。
5. 公式输入正确后点击确定，该公式便会添加在数据表的最下方。
6. 双击该公式即可将公式加入到搜索框内，公式计算结果会显示在报表中。

![](images/word-image-64.png)

图表2. 5 公式

DataFocus系统中的公式，包括聚合公式、分析公式、日期公式、混合函数、数字函数、逻辑操作符、文本操作函数等等，使用简单但多样。在今后的文章中，再为大家详细介绍如何使用DataFocus系统公式，对Excel数据表中数据进行计算与查看。
