---
title: "将Excel表导入DataFocus中进行数据分析时需要注意什么"
date: "2020-11-11"
categories: 
  - "02"
  - "03"
---

## 用DataFocus对Excel表进行数据分析

在Excel表中进行数据分析，要求使用单层表头、不留空白单元格、不使用合并单元格等等。那么将Excel表导入DataFocus中进行数据分析时，也需要如此么？将Excel表导入DataFocus中进行数据分析时需要注意什么呢？

## 数据类型

### 1.1 Excel表中数据格式

存于Excel表中的列名及列信息（字段和记录），可以全部存为“常规”或者“文本”格式，在将其导入DataFocus时，系统会自动识别列信息的数据类型。数据类型支持string、int、double、date、bool、timestamp、bigint、smallint 等。

### 1.2 更改数据类型

在选择Excel表上传到系统，进行表的信息配置时，最好再检查一下各个列的数据类型，一般记录内容为数值的列，若不需要进行计算的，可以手动更改为字符串类型（string）。而列信息中含特殊符号的，可能会被识别为字符串类型处理。

![](images/word-image-35.png)

图1. 1 数据类型

## 二、内容与形式

### 2.1空白单元格

与Excel进行数据分析时要求不一样的是，Excel表中可以出现空白单元格 。将其导入DataFocus系统时，系统会识别出表中空白数据，在数据分析过程中可以使用关键词或公式筛选出空值。

![](images/word-image-36.png)

图2. 1排除空值

### 2.2一维表与二维表

通过数据表中每一列的内容是否为一个独立参数可以简单判断该表是一维表格还是二维表格。一维表中每一列的内容为一个独立参数，如图2.1。若数据表为二维表，每一列都是同类参数，如图2.2。

![](images/word-image-37.png)

图2. 2 一维表

![](images/word-image-38.png)

图2. 3 二维表

数据整理为一维表，较利于对表中所有数据直接进行搜索式分析。而二维Excel表，在导入DataFocus后，可以通过数据转换中的“列转行”功能，将其转为一维表，进而对多项信息进行数据分析。

![](images/word-image-39.png)

图2. 4 进行数据转换

### 2.3 特殊字符

因为DataFocus是采用搜索式分析的 ，所以，若Excel表中出现例如“（）”、“+”、“=”这些在搜索的时候要用的、影响搜索的特殊字符，在导入过程中会被转掉，通常转成“\_”。

### 2.4 使用单层表头

因为 DataFocus是对Excel的表头进行自动识别，所以导入的Excel表需要使用单层表头，即每一列信息，存在单层列名。这点与Excel数据分析的要求相同。

## 三、导入本地Excel表到DataFocus

1\. 在DataFocus的数据表管理模块中点击“导入表”按钮（或资源管理功能模块中点击“创建资源”按钮），选择“从本地导入表”，会弹出如图界面；

![](images/word-image-40.png)

图2. 5导入Excel表

2\. 在“请选择文件”按钮上方会提示目前支持的文件类型及文件大小，选定EXCEL文件类型，点击“请选择文件”按钮，将电脑中想要导入且符合要求的数据文本导入，选择好后再点击上传；

3\. 文件上传成功后会显示如图的Excel表配置信息界面。可选择导入的列、重新命名表名及列名、可修改列类型，还可以预览导入的数据表，配置完成确认无误后点击“确定”，导入的文件会按照文件类型进行区分，比如导入Excel文件，就显示Excel。

![](images/word-image-41.png)

图2. 6 配置信息

导入Excel表到DataFocus系统中是如此简单，你，学会了么？
